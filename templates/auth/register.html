{% extends "inc/base.html" %}
{% block title %}Kayıt Ol{% endblock %}
{% block content %}
<section class="py-12">
    <div class="max-w-lg mx-auto bg-surface rounded-2xl elevation-2 px-8 py-10">
        <h1 class="text-2xl font-semibold text-on-background mb-6 text-center">Bestwork Ailesine Katılın</h1>

        <form method="post" class="space-y-5">
            {% if sponsor_info %}
            <div class="px-4 py-3 rounded-xl border border-error/50 bg-error/10 text-error text-sm font-semibold">
                Sponsor: {{ sponsor_info.name }}
            </div>
            {% endif %}
            <div>
                <label for="name" class="block text-sm font-medium text-on-surface mb-1">Ad Soyad</label>
                <input
                    id="name"
                    name="name"
                    type="text"
                    required
                    value="{{ name or '' }}"
                    class="w-full px-4 py-3 rounded-xl border border-outline-variant focus:outline-none focus:ring-2 focus:ring-primary bg-surface-variant text-on-surface"
                    placeholder="Adınız ve soyadınız"
                >
            </div>

            <div>
                <label for="email" class="block text-sm font-medium text-on-surface mb-1">E-posta</label>
                <input
                    id="email"
                    name="email"
                    type="email"
                    required
                    value="{{ email or '' }}"
                    class="w-full px-4 py-3 rounded-xl border border-outline-variant focus:outline-none focus:ring-2 focus:ring-primary bg-surface-variant text-on-surface"
                    placeholder="ornek@mail.com"
                >
            </div>

            <div>
                <label for="phone" class="block text-sm font-medium text-on-surface mb-1">Telefon Numarası</label>
                <input
                    id="phone"
                    name="phone"
                    type="tel"
                    required
                    value="{{ phone or '' }}"
                    class="w-full px-4 py-3 rounded-xl border border-outline-variant focus:outline-none focus:ring-2 focus:ring-primary bg-surface-variant text-on-surface"
                    placeholder="Örn. +905551112233"
                >
            </div>

            <div>
                <label for="identity_number" class="block text-sm font-medium text-on-surface mb-1">T.C. Kimlik Numarası</label>
                <input
                    id="identity_number"
                    name="identity_number"
                    type="text"
                    required
                    value="{{ identity_number or '' }}"
                    class="w-full px-4 py-3 rounded-xl border border-outline-variant focus:outline-none focus:ring-2 focus:ring-primary bg-surface-variant text-on-surface"
                    placeholder="11 haneli T.C. Kimlik numaranız"
                >
            </div>

            <div>
                <label for="country_code" class="block text-sm font-medium text-on-surface mb-1">Ülke</label>
                <select
                    id="country_code"
                    name="country_code"
                    required
                    class="w-full px-4 py-3 rounded-xl border border-outline-variant focus:outline-none focus:ring-2 focus:ring-primary bg-surface-variant text-on-surface"
                >
                    {% for country in countries %}
                        <option value="{{ country.dial_code }}" {% if selected_country == country.dial_code %}selected{% endif %}>
                            {{ country.name }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            {% if requires_referral %}
            <div>
                <label for="sponsor_code" class="block text-sm font-medium text-on-surface mb-1">Referans Kodu</label>
                <input
                    id="sponsor_code"
                    name="sponsor_code"
                    type="text"
                    minlength="3"
                    required
                    value="{{ sponsor_code or '' }}"
                    class="w-full px-4 py-3 rounded-xl border border-outline-variant focus:outline-none focus:ring-2 focus:ring-primary bg-surface-variant text-on-surface uppercase tracking-wide"
                    placeholder="Örn. TR12345678"
                >
                <p class="text-xs text-on-surface-variant mt-1">Sizi davet eden üyeden aldığınız kodu girin.</p>
            </div>
            {% else %}
            <div class="px-4 py-3 rounded-xl bg-secondary-container text-on-secondary-container text-sm">
                İlk lider hesabı oluşturuluyor. Referans kodu gerekmiyor.
            </div>
            {% endif %}

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="password" class="block text-sm font-medium text-on-surface mb-1">Şifre</label>
                    <input
                        id="password"
                        name="password"
                        type="password"
                        required
                        minlength="6"
                        class="w-full px-4 py-3 rounded-xl border border-outline-variant focus:outline-none focus:ring-2 focus:ring-primary bg-surface-variant text-on-surface"
                        placeholder="En az 6 karakter"
                    >
                </div>

                <div>
                    <label for="password_confirm" class="block text-sm font-medium text-on-surface mb-1">Şifre Tekrarı</label>
                    <input
                        id="password_confirm"
                        name="password_confirm"
                        type="password"
                        required
                        class="w-full px-4 py-3 rounded-xl border border-outline-variant focus:outline-none focus:ring-2 focus:ring-primary bg-surface-variant text-on-surface"
                        placeholder="Şifrenizi tekrar girin"
                    >
                </div>
            </div>

            <button
                type="submit"
                class="w-full py-3 rounded-full bg-primary text-on-primary font-semibold hover:elevation-2 transition-all state-layer"
            >
                Kayıt Ol
            </button>
        </form>

        <p class="text-sm text-center text-on-surface-variant mt-6">
            Zaten bir hesabınız var mı?
            <a href="{{ url_for('login') }}" class="text-primary font-medium hover:underline">Giriş yapın.</a>
        </p>
    </div>
</section>
{% endblock %}
