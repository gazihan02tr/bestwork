{% extends "bestsoft/inc/base.html" %}
{% block title %}Duyuru Yönetimi{% endblock %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block content %}
<div class="space-y-6">
   <div class="bg-white border border-neutral-tertiary/30 rounded-xl shadow-sm p-6">
      <h1 class="text-2xl font-semibold text-heading mb-4 flex items-center gap-2">
         <span class="material-symbols-outlined text-blue-600">campaign</span>
         Duyuru Yönetimi
      </h1>
      <form method="post" action="{{ url_for('bestsoft_announcements') }}" class="space-y-4">
         <input type="hidden" name="form_type" value="announcement">
         <div>
            <label for="announcement-content" class="block text-sm font-medium text-neutral-tertiary mb-1">Yeni duyuru</label>
            <textarea id="announcement-content" name="content" rows="3" class="w-full rounded-lg border border-neutral-tertiary/40 focus:ring-2 focus:ring-blue-600 focus:border-blue-600 text-sm p-3" placeholder="Duyuru metnini yazın..." required></textarea>
         </div>
         <div class="flex justify-end">
            <button type="submit" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors">
               <span class="material-symbols-outlined text-base">add_circle</span>
               Kaydet
            </button>
         </div>
      </form>
   </div>

   <div class="bg-white border border-neutral-tertiary/30 rounded-xl shadow-sm p-6">
      <div class="flex flex-col gap-2 mb-4">
         <h2 class="text-xl font-semibold text-heading">Kayıtlı Duyurular</h2>
         <p class="text-sm text-neutral-tertiary">Metni düzenleyebilir veya kaydı silebilirsiniz.</p>
      </div>
      {% if announcements %}
      <div class="space-y-4">
         {% for announcement in announcements %}
         <div class="border border-neutral-tertiary/30 rounded-lg p-4 space-y-3">
            <form method="post" action="{{ url_for('update_announcement', announcement_id=announcement.id) }}" class="flex flex-col gap-3 md:flex-row md:items-center">
               <label class="sr-only" for="announcement-{{ announcement.id }}">Duyuru</label>
               <input id="announcement-{{ announcement.id }}" name="content" type="text" value="{{ announcement.content }}" class="flex-1 rounded-lg border border-neutral-tertiary/40 focus:ring-2 focus:ring-blue-600 focus:border-blue-600 text-sm p-2.5" required>
               <button type="submit" class="inline-flex items-center gap-1 px-3 py-2 rounded-lg bg-amber-500/10 text-amber-700 border border-amber-500/30 hover:bg-amber-500/20 transition-colors text-sm self-start">
                  <span class="material-symbols-outlined text-base">edit</span>
                  Güncelle
               </button>
            </form>
            <form method="post" action="{{ url_for('delete_announcement', announcement_id=announcement.id) }}">
               <button type="submit" class="inline-flex items-center gap-1 px-3 py-2 rounded-lg bg-red-500/10 text-red-700 border border-red-500/30 hover:bg-red-500/20 transition-colors text-sm">
                  <span class="material-symbols-outlined text-base">delete</span>
                  Sil
               </button>
            </form>
            <div class="text-xs text-neutral-tertiary">
               Güncellendi: {{ announcement.updated_at_display or announcement.created_at_display or "—" }}
            </div>
         </div>
         {% endfor %}
      </div>
      {% else %}
      <p class="text-sm text-neutral-tertiary">Henüz duyuru bulunmuyor.</p>
      {% endif %}
   </div>
</div>
{% endblock %}
