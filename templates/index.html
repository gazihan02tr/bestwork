{% extends "inc/base.html" %}
{% block title %}Index{% endblock %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block content %}
        <!-- Hero Section -->
<section class="bg-white text-slate-900 relative overflow-hidden">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-6 relative z-10">
        {% set slider_items = slider_images if slider_images is defined else [] %}
        {% if slider_items %}
        <div class="relative" data-leader-slider data-slider-interval="{{ slider_transition_seconds|default(6.5) }}">
            <div
                class="slider-ambient pointer-events-none absolute inset-0 -z-10 opacity-0 transition duration-700 ease-out flex items-center justify-center"
                data-slider-ambient
            >
                <div class="slider-ambient__glow w-[96%] h-[96%] rounded-[42px] blur-[75px]" data-slider-ambient-glow></div>
            </div>
            <div class="overflow-hidden rounded-[30px] min-h-[320px] sm:min-h-[420px]" data-slider-surface>
                <div class="flex transition-transform duration-700 ease-[cubic-bezier(.4,0,.2,1)]" data-slider-track>
                    {% for image in slider_items %}
                    <article class="w-full flex-shrink-0 px-4 sm:px-3 py-3 relative">
                        <figure class="rounded-[30px] overflow-hidden h-[300px] sm:h-[420px] lg:h-[500px]">
                            <img src="{{ image.url }}" alt="Slider görseli {{ loop.index }}" class="w-full h-full object-cover" loading="lazy">
                        </figure>
                    </article>
                    {% endfor %}
                </div>
            </div>
            <button
                type="button"
                class="absolute left-3 sm:left-4 top-1/2 -translate-y-1/2 inline-flex items-center justify-center w-10 h-10 sm:w-11 sm:h-11 rounded-full bg-white text-slate-900 shadow-xl border border-white/40 hover:scale-105 transition"
                data-slider-prev
                aria-label="Önceki slayt"
            >
                <span class="material-symbols-outlined">chevron_left</span>
            </button>
            <button
                type="button"
                class="absolute right-3 sm:right-4 top-1/2 -translate-y-1/2 inline-flex items-center justify-center w-10 h-10 sm:w-11 sm:h-11 rounded-full bg-white text-slate-900 shadow-xl border border-white/40 hover:scale-105 transition"
                data-slider-next
                aria-label="Sonraki slayt"
            >
                <span class="material-symbols-outlined">chevron_right</span>
            </button>
            <div class="flex items-center justify-center gap-2 mt-4" data-slider-dots></div>
        </div>
        {% else %}
        <div class="rounded-[28px] border border-dashed border-slate-200 bg-white/80 py-16 flex items-center justify-center text-center">
            <p class="text-sm sm:text-base text-slate-500">
                Henüz slider görseli yüklenmemiş. BestSoft panelinden yeni görseller ekleyebilirsiniz.
            </p>
        </div>
        {% endif %}
    </div>
</section>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const slider = document.querySelector("[data-leader-slider]");
        if (!slider) return;
        const track = slider.querySelector("[data-slider-track]");
        const slides = Array.from(track.children);
        const ambient = slider.querySelector("[data-slider-ambient]");
        const ambientGlow = slider.querySelector("[data-slider-ambient-glow]");
        const prevBtn = slider.querySelector("[data-slider-prev]");
        const nextBtn = slider.querySelector("[data-slider-next]");
        const dotsWrap = slider.querySelector("[data-slider-dots]");
        if (!slides.length) {
            return;
        }
        const intervalSeconds = parseFloat(slider.dataset.sliderInterval || "6.5");
        const transitionIntervalMs = Math.max(intervalSeconds, 1) * 1000;
        const fallbackColor = { r: 18, g: 22, b: 36 };
        const slideColors = new Array(slides.length).fill(null);
        let index = 0;
        let autoplay;
        const hasMultiple = slides.length > 1;

        function applyAmbientColor(color) {
            if (!ambient || !ambientGlow) return;
            const source = color || fallbackColor;
            const { r, g, b } = source;
            ambientGlow.style.background = `
                radial-gradient(circle at 8% 15%, rgba(${r}, ${g}, ${b}, 0.55), transparent 55%),
                radial-gradient(circle at 92% 14%, rgba(${r}, ${g}, ${b}, 0.55), transparent 55%),
                radial-gradient(circle at 50% 96%, rgba(${r}, ${g}, ${b}, 0.5), transparent 65%),
                radial-gradient(circle at 50% 50%, rgba(${r}, ${g}, ${b}, 0.35), transparent 70%)
            `;
            ambientGlow.style.boxShadow = `
                0 45px 85px rgba(${r}, ${g}, ${b}, 0.25),
                0 0 140px rgba(${r}, ${g}, ${b}, 0.45)
            `;
            ambientGlow.style.opacity = "0.9";
            ambient.style.opacity = "1";
        }

        function extractColor(img, slideIndex) {
            if (!img) return;
            const canvas = document.createElement("canvas");
            const maxDim = 64;
            const width = img.naturalWidth || maxDim;
            const height = img.naturalHeight || maxDim;
            const scale = Math.min(maxDim / width, maxDim / height, 1);
            canvas.width = Math.max(1, Math.floor(width * scale));
            canvas.height = Math.max(1, Math.floor(height * scale));
            const ctx = canvas.getContext("2d");
            if (!ctx) return;
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            try {
                const { data } = ctx.getImageData(0, 0, canvas.width, canvas.height);
                let r = 0;
                let g = 0;
                let b = 0;
                let count = 0;
                const step = 4 * Math.max(1, Math.floor(data.length / 2000));
                for (let i = 0; i < data.length; i += step) {
                    r += data[i];
                    g += data[i + 1];
                    b += data[i + 2];
                    count++;
                }
                if (!count) return;
                slideColors[slideIndex] = {
                    r: Math.round(r / count),
                    g: Math.round(g / count),
                    b: Math.round(b / count),
                };
                if (slideIndex === index) {
                    applyAmbientColor(slideColors[slideIndex]);
                }
            } catch (error) {
                console.warn("Renk örneklenemedi:", error);
            }
        }

        slides.forEach((slide, slideIndex) => {
            const img = slide.querySelector("img");
            if (!img) return;
            if (img.complete) {
                extractColor(img, slideIndex);
            } else {
                img.addEventListener("load", () => extractColor(img, slideIndex), {
                    once: true,
                });
            }
        });
        applyAmbientColor(slideColors[index]);

        function goToSlide(newIndex) {
            index = (newIndex + slides.length) % slides.length;
            track.style.transform = `translateX(-${index * 100}%)`;
            updateDots();
            applyAmbientColor(slideColors[index]);
        }

        function nextSlide() {
            goToSlide(index + 1);
        }

        function prevSlide() {
            goToSlide(index - 1);
        }

        function buildDots() {
            if (!dotsWrap) return;
            dotsWrap.innerHTML = "";
            if (!hasMultiple) {
                dotsWrap.classList.add("opacity-0", "pointer-events-none");
                return;
            }
            dotsWrap.classList.remove("opacity-0", "pointer-events-none");
            slides.forEach((_, slideIndex) => {
                const dot = document.createElement("button");
                dot.type = "button";
                dot.className = "w-3 h-3 rounded-full bg-white/40 hover:bg-white transition";
                dot.setAttribute("aria-label", `Slayt ${slideIndex + 1}`);
                dot.addEventListener("click", () => {
                    goToSlide(slideIndex);
                    restartAutoplay();
                });
                dotsWrap.appendChild(dot);
            });
        }

        function updateDots() {
            if (!dotsWrap || !hasMultiple) return;
            dotsWrap.querySelectorAll("button").forEach((dot, dotIndex) => {
                if (dotIndex === index) {
                    dot.classList.add("bg-white");
                    dot.classList.remove("bg-white/40");
                } else {
                    dot.classList.remove("bg-white");
                    dot.classList.add("bg-white/40");
                }
            });
        }

        function restartAutoplay() {
            if (!hasMultiple) return;
            clearInterval(autoplay);
            autoplay = setInterval(nextSlide, transitionIntervalMs);
        }

        buildDots();
        updateDots();
        if (hasMultiple) {
            autoplay = setInterval(nextSlide, transitionIntervalMs);
        } else {
            prevBtn?.classList.add("opacity-40", "pointer-events-none");
            nextBtn?.classList.add("opacity-40", "pointer-events-none");
        }

        prevBtn?.addEventListener("click", () => {
            prevSlide();
            restartAutoplay();
        });
        nextBtn?.addEventListener("click", () => {
            nextSlide();
            restartAutoplay();
        });

        slider.addEventListener("mouseenter", () => {
            if (hasMultiple) {
                clearInterval(autoplay);
            }
        });
        slider.addEventListener("mouseleave", () => {
            if (hasMultiple) {
                restartAutoplay();
            }
        });
    });
</script>





<!-- Categories Section -->
    <section class="py-12 sm:py-16 lg:py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="mb-10">
                <h2 class="text-3xl sm:text-4xl font-normal mb-2 text-on-background">Kategoriler</h2>
                <p class="text-lg text-on-surface-variant">İhtiyacınıza uygun ürün grubunu seçin</p>
            </div>
            
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6">
                
                <!-- Category Card 1 -->
                <a href="#" class="group bg-surface rounded-2xl elevation-1 hover:elevation-3 overflow-hidden transition-all duration-300 state-layer">
                    <div class="aspect-square bg-gradient-to-br from-purple-400 to-purple-600 flex items-center justify-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-br from-purple-400/90 to-purple-600/90"></div>
                        <img src="https://images.unsplash.com/photo-1505576399279-565b52d4ac71?w=800&q=80" alt="Beslenme" class="absolute inset-0 w-full h-full object-cover mix-blend-overlay opacity-60">
                        <div class="absolute inset-0 bg-amber-300 opacity-0 group-hover:opacity-20 transition-opacity"></div>
                        <span class="relative z-10 text-white text-6xl font-bold">B</span>
                    </div>
                    <div class="p-4 sm:p-6">
                        <h3 class="text-lg sm:text-xl font-medium mb-1">Beslenme</h3>
                        <p class="text-sm text-on-surface-variant">Vitaminler ve takviyeler</p>
                    </div>
                </a>

                <!-- Category Card 2 -->
                <a href="#" class="group bg-surface rounded-2xl elevation-1 hover:elevation-3 overflow-hidden transition-all duration-300 state-layer">
                    <div class="aspect-square bg-gradient-to-br from-amber-400 to-amber-600 flex items-center justify-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-br from-amber-400/90 to-amber-600/90"></div>
                        <img src="https://images.unsplash.com/photo-1596755389378-c31d21fd1273?w=800&q=80" alt="Güzellik" class="absolute inset-0 w-full h-full object-cover mix-blend-overlay opacity-60">
                        <div class="absolute inset-0 bg-purple-400 opacity-0 group-hover:opacity-20 transition-opacity"></div>
                        <span class="relative z-10 text-white text-6xl font-bold">G</span>
                    </div>
                    <div class="p-4 sm:p-6">
                        <h3 class="text-lg sm:text-xl font-medium mb-1">Güzellik</h3>
                        <p class="text-sm text-on-surface-variant">Cilt ve saç bakımı</p>
                    </div>
                </a>

                <!-- Category Card 3 -->
                <a href="#" class="group bg-surface rounded-2xl elevation-1 hover:elevation-3 overflow-hidden transition-all duration-300 state-layer">
                    <div class="aspect-square bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/90 to-yellow-600/90"></div>
                        <img src="https://images.unsplash.com/photo-1585421514738-01798e348b17?w=800&q=80" alt="Ev Bakımı" class="absolute inset-0 w-full h-full object-cover mix-blend-overlay opacity-60">
                        <div class="absolute inset-0 bg-purple-400 opacity-0 group-hover:opacity-20 transition-opacity"></div>
                        <span class="relative z-10 text-white text-6xl font-bold">E</span>
                    </div>
                    <div class="p-4 sm:p-6">
                        <h3 class="text-lg sm:text-xl font-medium mb-1">Ev Bakımı</h3>
                        <p class="text-sm text-on-surface-variant">Temizlik ürünleri</p>
                    </div>
                </a>

                <!-- Category Card 4 -->
                <a href="#" class="group bg-surface rounded-2xl elevation-1 hover:elevation-3 overflow-hidden transition-all duration-300 state-layer">
                    <div class="aspect-square bg-gradient-to-br from-violet-400 to-violet-600 flex items-center justify-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-br from-violet-400/90 to-violet-600/90"></div>
                        <img src="https://images.unsplash.com/photo-1556228578-0d85b1a4d571?w=800&q=80" alt="Kişisel Bakım" class="absolute inset-0 w-full h-full object-cover mix-blend-overlay opacity-60">
                        <div class="absolute inset-0 bg-amber-300 opacity-0 group-hover:opacity-20 transition-opacity"></div>
                        <span class="relative z-10 text-white text-6xl font-bold">K</span>
                    </div>
                    <div class="p-4 sm:p-6">
                        <h3 class="text-lg sm:text-xl font-medium mb-1">Kişisel Bakım</h3>
                        <p class="text-sm text-on-surface-variant">Günlük bakım</p>
                    </div>
                </a>

            </div>
        </div>
    </section>

    <!-- Featured Products -->
    <section id="urunler" class="py-12 sm:py-16 lg:py-20 bg-surface-variant/30">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            
            <div class="flex items-end justify-between mb-10">
                <div>
                    <h2 class="text-3xl sm:text-4xl font-normal mb-2 text-on-background">Öne Çıkan Ürünler</h2>
                    <p class="text-lg text-on-surface-variant">En çok tercih edilen ürünlerimiz</p>
                </div>
                <a href="#urunler" class="hidden sm:inline-flex items-center gap-1 text-primary font-medium hover:gap-2 transition-all">
                    Tümünü Gör
                    <span class="material-symbols-outlined">arrow_forward</span>
                </a>
            </div>

            {% if products %}
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6">
                {% for product in products %}
                <div class="group bg-surface rounded-2xl elevation-2 hover:elevation-4 overflow-hidden transition-all duration-300">
                    <div class="relative aspect-square bg-surface-variant flex items-center justify-center overflow-hidden">
                        <img src="{{ product.image_url }}" alt="{{ product.name }}" class="w-full h-full object-cover">
                        <button class="absolute top-3 right-3 p-2 bg-surface rounded-full elevation-1 state-layer text-on-surface opacity-0 group-hover:opacity-100 transition-opacity">
                            <span class="material-symbols-outlined text-xl">favorite</span>
                        </button>
                    </div>
                    <div class="p-5 space-y-4">
                        <div>
                            <p class="text-xs uppercase tracking-wide text-on-surface-variant">{{ product.category }}</p>
                            <h3 class="font-medium text-lg text-on-surface line-clamp-2">{{ product.name }}</h3>
                            <p class="text-sm text-on-surface-variant line-clamp-2 mt-1">{{ product.description }}</p>
                        </div>
                        <div class="flex items-baseline gap-2">
                            <span class="text-2xl font-bold text-primary">{{ '%.2f'|format(product.price) }} ₺</span>
                        </div>
                        <form method="post" action="{{ url_for('add_to_cart', product_id=product.id) }}" class="flex items-center gap-3">
                            <label for="qty-{{ product.id }}" class="text-sm text-on-surface-variant">Adet</label>
                            <input
                                id="qty-{{ product.id }}"
                                name="quantity"
                                type="number"
                                min="1"
                                value="1"
                                class="w-16 px-3 py-2 rounded-lg border border-outline-variant focus:outline-none focus:ring-2 focus:ring-primary text-center bg-surface-variant"
                            >
                            <button type="submit" class="flex-1 py-3 bg-primary text-on-primary rounded-full font-medium hover:elevation-1 transition-all state-layer">
                                Sepete Ekle
                            </button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="bg-surface rounded-2xl elevation-1 px-8 py-12 text-center text-on-surface-variant">
                Şu anda listelenecek ürün bulunamadı. Lütfen daha sonra tekrar deneyin.
            </div>
            {% endif %}

        </div>
    </section>

    <!-- Benefits Section -->
    <section class="py-12 sm:py-16 lg:py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8">
                
                <!-- Benefit 1 -->
                <div class="text-center">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-primary-container rounded-full mb-4">
                        <span class="material-symbols-outlined text-primary text-3xl">local_shipping</span>
                    </div>
                    <h3 class="text-xl font-medium mb-2">Ücretsiz Kargo</h3>
                    <p class="text-on-surface-variant">500 TL ve üzeri tüm siparişlerinizde</p>
                </div>

                <!-- Benefit 2 -->
                <div class="text-center">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-secondary-container rounded-full mb-4">
                        <span class="material-symbols-outlined text-secondary text-3xl">verified_user</span>
                    </div>
                    <h3 class="text-xl font-medium mb-2">Memnuniyet Garantisi</h3>
                    <p class="text-on-surface-variant">180 gün içinde koşulsuz iade</p>
                </div>

                <!-- Benefit 3 -->
                <div class="text-center">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-tertiary-container rounded-full mb-4">
                        <span class="material-symbols-outlined text-tertiary text-3xl">support_agent</span>
                    </div>
                    <h3 class="text-xl font-medium mb-2">7/24 Destek</h3>
                    <p class="text-on-surface-variant">Uzman ekibimiz her zaman yanınızda</p>
                </div>

            </div>
        </div>
    </section>

    <!-- Newsletter Section -->
    <section class="py-12 sm:py-16 lg:py-20 bg-gradient-to-r from-primary via-purple-600 to-purple-700 text-white relative overflow-hidden">
        <div class="absolute inset-0 opacity-20">
            <div class="absolute top-0 left-1/4 w-96 h-96 bg-secondary rounded-full blur-3xl"></div>
            <div class="absolute bottom-0 right-1/4 w-96 h-96 bg-amber-400 rounded-full blur-3xl"></div>
        </div>
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10">
            <span class="material-symbols-outlined text-secondary mb-4" style="font-size: 48px;">mail</span>
            <h2 class="text-3xl sm:text-4xl font-normal mb-3">Kampanyalardan Haberdar Olun</h2>
            <p class="text-lg opacity-90 mb-8">Özel fırsatlar ve yeni ürünlerden ilk siz haberdar olun</p>
            
            <div class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
                <input 
                    type="email" 
                    placeholder="E-posta adresiniz" 
                    class="flex-1 px-6 py-4 rounded-full bg-white/20 backdrop-blur-sm text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-secondary border border-white/30"
                >
                <button class="px-8 py-4 bg-secondary text-on-secondary rounded-full font-medium hover:bg-amber-500 transition-all shadow-lg whitespace-nowrap">
                    Kayıt Ol
                </button>
            </div>
        </div>
    </section>

   
{% endblock %}


  
